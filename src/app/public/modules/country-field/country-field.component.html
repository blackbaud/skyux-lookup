<ng-container *ngIf="!inputBoxHostService">
  <ng-container *ngTemplateOutlet="inputTemplateRef"></ng-container>
</ng-container>

<ng-template
  #inputTemplateRef
>
  <span
    class="sky-country-field-container"
    [ngClass]="{
      'sky-country-field-disabled': disabled
    }"
  >
    <sky-autocomplete
      [ariaLabelledBy]="inputId"
      [data]="countries"
      [propertiesToSearch]="['name', 'iso2']"
      [searchResultTemplate]="countrySearchResultTemplate"
      [searchTextMinimumCharacters]="searchTextMinimumCharacters"
      (selectionChange)="onCountrySelected($event)"
    >
      <div
        class="sky-country-field-input"
        [ngClass]="{
          'sky-country-field-input-with-flag':
            selectedCountry && selectedCountry.iso2 && !isInPhoneField
        }"
      >
        <div *ngIf="selectedCountry && selectedCountry.iso2 && !isInPhoneField"
          class="sky-country-field-flag iti-flag"
          [ngClass]="selectedCountry.iso2.toLowerCase()"
        ></div>
        <input
          class="sky-form-control"
          name="selectedCountry"
          skyAutocomplete
          type="text"
          [attr.aria-label]="'skyux_country_field_search_placeholder' | skyLibResources"
          [attr.disabled]="disabled ? true : undefined"
          [attr.id]="inputId"
          [autocompleteAttribute]="autocompleteAttribute"
          [formControl]="countrySearchFormControl"
          [placeholder]="'skyux_country_field_search_placeholder' | skyLibResources"
          (blur)="onAutocompleteBlur()"
          #countrySearchInput
        >
      </div>
    </sky-autocomplete>
  </span>
</ng-template>

<ng-template
  let-item="item"
  #countrySearchResultTemplate
>
  <div
    class="sky-country-field-search-result-flag"
    [ngClass]="'iti-flag ' + item.iso2.toLowerCase()"
  >
  </div>
  {{ item.name }}
  <span *ngIf="isInPhoneField"
    class="sky-deemphasized"
  >
    {{ item.dialCode }}
  </span>
</ng-template>
